# Multipoles

Implementation of the CoMet algorithm [1] for finding multipoles in time series data.

For a given set of timeseries, a multipole is defined as a subset of two or more timeseries whose dependence and gain are not less than the corresponding user-defined thresholds.
- **Dependence** of a set of timeseries is defined as the minimum of the variance of the possible linear combinations. It is computed as 1 minus the least eigenvalue of the pairwise correlation matrix of this set.
- **Gain** of a set of timeseries is defined as the least contribution among all the constituent timeseries to the dependence of this set. It is computed as difference between the dependence of the given set and the maximum dependence of subsets generated by removing each timeseries from the set.

CoMet algorithm is implemented in two ways. 1. When search process is serial. 2. When search process is parallel. The latter leverages the multiple processes available on state-of-the-art computers or compute nodes in a cluster.


## Requirements
Julia 1.0 [2] (Later versions have not been tested)

Packages:
- Combinatorics (v"1.0.2" tested)
- LightGraphs (v"1.3.3" tested)

## How to run

**In serial:** all steps are executed in serial 
  ```julia
  julia>include("COMETserial.jl")
  julia>COMETserial(corMat, delta, sigma)
  ```

**In parallel:** the multipole exploration step from candidates is parallelized such that each processor iterates through all subsets of a candidate. For a set of 100 timeseries, the parallel code can provide a speed-up between 10x to 100x from the serial code.
  ```julia 
  julia>include("COMETparallel.jl")
  julia>COMETparallel(corMat, delta, sigma)
  ```

Input:
  - **corMat**: pairwise correlation matrix as a 2D array
  - **delta**: the gain threshold
  - **sigma**: the dependence threshold

Return:
  - Vector of multipoles is a structure as defined below
    ```julia
    struct poles_t{F<:AbstractFloat,I<:Signed}
        dept::F # dependence
        gain::F # gain
        mem::Vector{I}  # indices of member timeseries
    end
    ```

## References
[1] Agrawal, S., Steinbach, M., Boley, D., Chatterjee, S., Atluri, G., Dang, A. T., ... & Kumar, V. (2019). Mining Novel Multivariate Relationships in Time Series Data Using Correlation Networks. IEEE Transactions on Knowledge and Data Engineering.

[2] Julia Download: https://julialang.org/downloads/oldreleases/
